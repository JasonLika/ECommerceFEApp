@page "/tickets"
@using ECommerceFEApp.Services; 
@using ECommerceFEApp.Models;
@inject TicketService TicketService
@inject CartService CartService;
@inject NavigationManager Navigation;

<h3>Tickets</h3>
 
<table class="table">
<thead>
<tr>
<th>ID</th>
<th>Title</th>
<th>Description</th>
<td>
<button class="btn btn-warning" @onclick="() => NavigateToCreateTicket()">Create Ticket</button>
</td>
</tr>
</thead>
<tbody>
    @foreach (var ticket in TicketList)
    {
<tr>
<td>@ticket.Id</td>
<td>@ticket.Title</td>
<td>@ticket.Description</td>
</tr>
    }
</tbody>
</table>

@code {
    private List<Ticket> TicketList = new();
    private UserProfile user;

 
    protected override async Task OnInitializedAsync()
    {
        //TicketList = await TicketService.GetTicketsAsync();

        var allTickets = await TicketService.GetTicketsAsync();
        user = await CartService.GetCurrentUserProfileAsync();
        var userId = user.Id;
        TicketList = allTickets.Where(ticket => ticket.UserId == userId).ToList();
    }

    private void NavigateToCreateTicket() {
        Navigation.NavigateTo($"/createtickets");
    }


    /*
    private void NavigateToUpdate(int id) {
        Navigation.NavigateTo($"/update-product/{id}");
    }
    private async Task DeleteProduct(int id) {
        await ProductService.DeleteProductAsync(id);
        ProductList = await ProductService.GetProductsAsync();
    }
    */
}